

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/avatar.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="CarlChu">
  <meta name="keywords" content="">
  
    <meta name="description" content="MySQL基础 123456789101112131415mysql -uroot -p; -- 连接数据库flush privileges; -- 刷新权限show databases; -- 查看所有的数据库use 数据库名; -- 切换数据库show tables; -- 查看所有的表describe&#x2F;desc 数据表; -- 显示表信息create database 数据库名; -- 创建">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础">
<meta property="og:url" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="CarlChu&#39;s blog">
<meta property="og:description" content="MySQL基础 123456789101112131415mysql -uroot -p; -- 连接数据库flush privileges; -- 刷新权限show databases; -- 查看所有的数据库use 数据库名; -- 切换数据库show tables; -- 查看所有的表describe&#x2F;desc 数据表; -- 显示表信息create database 数据库名; -- 创建">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/20181103160140252.png">
<meta property="og:image" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/image-20210715114955960.png">
<meta property="og:image" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/image-20220902113957460.png">
<meta property="og:image" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB.png">
<meta property="article:published_time" content="2021-08-06T18:53:42.000Z">
<meta property="article:modified_time" content="2023-05-13T15:38:33.468Z">
<meta property="article:author" content="CarlChu">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://carl-chu.github.io/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/20181103160140252.png">
  
  
  
  <title>MySQL基础 - CarlChu&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"carl-chu.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>CarlChu</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MySQL基础"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-08-06 18:53" pubdate>
          2021年8月6日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          121 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">MySQL基础</h1>
            
            
              <div class="markdown-body">
                
                <p>MySQL基础</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p; <span class="hljs-comment">-- 连接数据库</span><br><br>flush privileges; <span class="hljs-comment">-- 刷新权限</span><br><br><span class="hljs-keyword">show</span> databases; <span class="hljs-comment">-- 查看所有的数据库</span><br><br>use 数据库名; <span class="hljs-comment">-- 切换数据库</span><br><br><span class="hljs-keyword">show</span> tables; <span class="hljs-comment">-- 查看所有的表</span><br><br><span class="hljs-keyword">describe</span><span class="hljs-operator">/</span><span class="hljs-keyword">desc</span> 数据表; <span class="hljs-comment">-- 显示表信息</span><br><br><span class="hljs-keyword">create</span> database 数据库名; <span class="hljs-comment">-- 创建数据库</span><br><br>exit; <span class="hljs-comment">-- 退出连接</span><br></code></pre></td></tr></table></figure>

<p>数据库XXX语言</p>
<p>DDL	定义</p>
<p>DML	操作</p>
<p>DQL	查询</p>
<p>DCL	控制</p>
<h2 id="1-操作数据库"><a href="#1-操作数据库" class="headerlink" title="1.操作数据库"></a>1.操作数据库</h2><p>操作数据库&gt;操作数据库中的表&gt;操作数据库中表的数据</p>
<p><font color="FF0000">mysql关键字不区分大小写</font></p>
<h3 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h3><p>1.创建数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>] 数据库名;<br></code></pre></td></tr></table></figure>

<p>2.删除数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> DATABASE [IF <span class="hljs-keyword">EXISTS</span>] 数据库名;<br></code></pre></td></tr></table></figure>

<p>3.使用数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- tab键上面，如果表名或字段名是一个特殊字符，就需要带``</span><br>USE `school`<br></code></pre></td></tr></table></figure>

<p>4.查看数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> DATABASES <span class="hljs-comment">-- 查看所有的数据库</span><br></code></pre></td></tr></table></figure>

<h3 id="数据库的列类型"><a href="#数据库的列类型" class="headerlink" title="数据库的列类型"></a>数据库的列类型</h3><blockquote>
<p>数值</p>
</blockquote>
<ul>
<li>tinyint	       十分小的数据	     1个字节</li>
<li>smallint        较小的数据            2个字节</li>
<li>mediumint   中等大小的数据    3个字节</li>
<li>int                 标准的整数            4个字节（常用）</li>
<li>bigint             较大的数据           8个字节</li>
<li>float               浮点数                   4个字节</li>
<li>double           浮点数                   8个字节</li>
<li>decimal          字符串形式的浮点数     金融计算的时候一般使用decimal</li>
</ul>
<blockquote>
<p>字符串</p>
</blockquote>
<ul>
<li>char              字符串固定大小     0-255<strong>字符</strong></li>
<li>varchar         可变字符串             0-65535字节（常用）</li>
<li>tinytext          微型文本                2^8 - 1（255字节）</li>
<li>text                 文本串                   2^16 - 1（65535字节）</li>
</ul>
<blockquote>
<p>时间日期</p>
</blockquote>
<p>java.util.Date</p>
<ul>
<li>date          YYYY-MM-DD，日期格式</li>
<li>time          HH:mm:ss，时间格式</li>
<li>datetime   YYYY-MM-DD  HH:mm:ss，最常用的时间格式</li>
<li>timestamp   时间戳，1970.1.1到现在的毫秒数，也较为常用</li>
<li>year            年份</li>
</ul>
<blockquote>
<p>null</p>
</blockquote>
<ul>
<li>没有值，未知</li>
<li><font color="FF0000">不要使用NULL进行运算，结果为NULL</font></li>
</ul>
<h3 id="数据库的字段属性（重点）"><a href="#数据库的字段属性（重点）" class="headerlink" title="数据库的字段属性（重点）"></a>数据库的字段属性（重点）</h3><p><strong>Unsigned：</strong></p>
<ul>
<li>无符号的整数</li>
<li>声明了该列不能声明为负数</li>
</ul>
<p><strong>zerofill：</strong></p>
<ul>
<li>0填充的</li>
<li>不足的位数，使用0来填充，int(3)，5 -&gt; 005</li>
</ul>
<p><strong>自增：</strong></p>
<ul>
<li>通常理解为自增，自动在上一条记录的基础上+1</li>
<li>通常用来设计唯一的主键 index，必须是整数类型</li>
<li>可以自定义设计主键自增的起始值和步长</li>
</ul>
<p><strong>非空 not null：</strong></p>
<ul>
<li>设置为not null，如果不给它赋值，就会报错</li>
<li>NULL，如果不填写值，默认就是null</li>
</ul>
<p><strong>默认：</strong></p>
<ul>
<li>设置默认的值</li>
</ul>
<h3 id="创建数据表"><a href="#创建数据表" class="headerlink" title="创建数据表"></a>创建数据表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>] `表名`(<br>	`字段名` 列类型 [属性] [索引] [注释],<br>    `字段名` 列类型 [属性] [索引] [注释],<br>    ...<br>    `字段名` 列类型 [属性] [索引] [注释],<br>)[表类型][字符集设置][注释]<br></code></pre></td></tr></table></figure>

<h3 id="数据表类型"><a href="#数据表类型" class="headerlink" title="数据表类型"></a>数据表类型</h3><p>数据库引擎</p>
<p>INNODB</p>
<p>MYISAM 早些年使用</p>
<table>
<thead>
<tr>
<th></th>
<th>MYISAM</th>
<th>INNODB</th>
</tr>
</thead>
<tbody><tr>
<td>事务支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>数据行锁定</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>外键约束</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>全文索引</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>表空间的大小</td>
<td>较小</td>
<td>较大，约为2倍</td>
</tr>
</tbody></table>
<p>常规使用操作：</p>
<ul>
<li>MYISAM	节约空间，速度较快</li>
<li>INNODB   安全性高，事务的处理，多表用户操作</li>
</ul>
<blockquote>
<p>在物理空间存在的位置（了解）</p>
</blockquote>
<p>所有的数据库文件都存在data目录下</p>
<p>本质还是文件的存储</p>
<p>MySQL引擎在物理文件上的区别</p>
<ul>
<li>InnoDB在数据表中只有一个*.frm文件，以及上级目录下的ibdata1文件</li>
<li>MYISAM对应的文件<ul>
<li>*.frm - 表结构的定义文件</li>
<li>*.MYD 数据文件(data)</li>
<li>*.MYI   索引文件(index)</li>
</ul>
</li>
</ul>
<blockquote>
<p>修改表</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 修改表名 ALTER TABLE 旧表名RENAME AS 新表名</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> teacher RENAME <span class="hljs-keyword">AS</span> teacher1<br><span class="hljs-comment">-- 增加表的字段 ALTER TABLE 表名 ADD 字段名 列属性</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> teacher1 <span class="hljs-keyword">ADD</span> age <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>)<br><span class="hljs-comment">-- 修改表的字段（重命名，修改约束）</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> teacher1 MODIFY age <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">11</span>) <span class="hljs-comment">-- 修改约束</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> teacher1 CHANGE age age1 <span class="hljs-type">INT</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">-- 字段重命名</span><br><br><span class="hljs-comment">-- 删除表的字段</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> teacher1 <span class="hljs-keyword">DROP</span> age1<br><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>删除</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 删除表</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> [IF <span class="hljs-keyword">EXISTS</span>] teacher1<br></code></pre></td></tr></table></figure>

<p>所有的创建和删除操作尽量加上判断，以免报错。</p>
<h2 id="2-MySQL数据管理"><a href="#2-MySQL数据管理" class="headerlink" title="2.MySQL数据管理"></a>2.MySQL数据管理</h2><h3 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h3><h3 id="DML语言"><a href="#DML语言" class="headerlink" title="DML语言"></a>DML语言</h3><p>数据库意义：数据存储，数据管理</p>
<p>DML语言：数据操作语言</p>
<ul>
<li>insert</li>
<li>update</li>
<li>delete</li>
</ul>
<h3 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 插入语句（添加）</span><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> 表名([字段名<span class="hljs-number">1</span>,字段<span class="hljs-number">2</span>,字段<span class="hljs-number">3</span>]) <span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;值1&#x27;</span>,<span class="hljs-string">&#x27;值2&#x27;</span>,<span class="hljs-string">&#x27;值3&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>注意事项：</p>
<ol>
<li>字段和字段之间使用英文逗号隔开</li>
<li>字段可以省略，但是后面的值必须要一一对应，不能少</li>
<li>可以同时插入多条数据，values后面的值，需要使用,隔开</li>
</ol>
<h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> 表名 <span class="hljs-keyword">set</span> colnum_name <span class="hljs-operator">=</span> <span class="hljs-keyword">value</span>,[colnum_name <span class="hljs-operator">=</span> <span class="hljs-keyword">value</span>,...] <span class="hljs-keyword">where</span> 条件<br></code></pre></td></tr></table></figure>

<ul>
<li>colnum_name是数据库的列，尽量带上&#96;&#96;</li>
<li>筛选的条件，如果没有指定，则会修改所有的列</li>
<li>value，是一个具体的值，也可以是一个变量</li>
<li>多个设置的属性之间，使用英文逗号隔开</li>
</ul>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><blockquote>
<p>delete命令</p>
</blockquote>
<p>语法：<code>delete from 表名 [where 条件]</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 删除数据（避免这样写，会全部删除）</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-comment">-- 删除指定数据</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> `student` <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>



<blockquote>
<p>TRUNCATE命令</p>
</blockquote>
<p>作用：完全清空一个数据表，表的结构和索引约束不会变</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 清空 student 表</span><br><span class="hljs-keyword">TRUNCATE</span> `student`<br></code></pre></td></tr></table></figure>



<blockquote>
<p>delete与TRUNCATE区别</p>
</blockquote>
<ul>
<li>相同点：都能删除数据，都不会删除表结构</li>
<li>不同点：<ul>
<li>TRUNCATE 重新设置自增列，计数器会归零</li>
<li>TRUNCATE 不会影响事务</li>
</ul>
</li>
</ul>
<h2 id="3-DQL查询数据（重点）"><a href="#3-DQL查询数据（重点）" class="headerlink" title="3.DQL查询数据（重点）"></a>3.DQL查询数据（重点）</h2><p>（Data Query Language）数据查询语言</p>
<p>SELECT完整语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">ALL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DISTINCT</span>]<br>&#123;<span class="hljs-operator">*</span> <span class="hljs-operator">|</span> table.<span class="hljs-operator">*</span> <span class="hljs-operator">|</span> [table.field[<span class="hljs-keyword">as</span> alias1][,table.field2[<span class="hljs-keyword">as</span> alias2]][,...]]&#125;<br><span class="hljs-keyword">FROM</span> table_name [<span class="hljs-keyword">as</span> table_allias]<br>	[<span class="hljs-keyword">left</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">right</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> table_name2] <span class="hljs-comment">-- 联合查询</span><br>	[<span class="hljs-keyword">WHERE</span> ...]	<span class="hljs-comment">-- 指定结果需要满足的条件</span><br>	[<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> ...] <span class="hljs-comment">-- 指定结果按照哪个字段来分组</span><br>	[<span class="hljs-keyword">HAVING</span>] <span class="hljs-comment">-- 过滤分组的记录必须满足的次要条件</span><br>	[<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>] <span class="hljs-comment">-- 指定查询记录按一个或多个条件排序</span><br>	[limit &#123;[<span class="hljs-keyword">offset</span>,]row_count&#125; <span class="hljs-operator">|</span> row_countOFFSET <span class="hljs-keyword">offset</span>()&#125;;<br>     <span class="hljs-comment">-- 查询记录的记录从哪至哪条</span><br></code></pre></td></tr></table></figure>



<h3 id="指定查询字段"><a href="#指定查询字段" class="headerlink" title="指定查询字段"></a>指定查询字段</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询全部的学生</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> student<br><br><span class="hljs-comment">-- 查询指定字段</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> student<br><br><span class="hljs-comment">-- 别名，给结果起一个名字 AS 可以给字段起别名，也可以给表起别名</span><br><span class="hljs-comment">-- 字段名 AS 别名</span><br><span class="hljs-keyword">SELECT</span> `StudentNo` <span class="hljs-keyword">AS</span> 学号,`StudentName` <span class="hljs-keyword">AS</span> 学生姓名 <span class="hljs-keyword">FROM</span> student <span class="hljs-keyword">AS</span> s<br><br><span class="hljs-comment">-- 函数 Concat(a,b)</span><br><span class="hljs-keyword">SELECT</span> CONCAT(<span class="hljs-string">&#x27;姓名：&#x27;</span>,StudentNmae) <span class="hljs-keyword">AS</span> 新名字 <span class="hljs-keyword">FROM</span> Student<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>去重 distinct</p>
</blockquote>
<p>作用：去除SELECT查询出来的结果中重复的数据，重复的数据只显示一条。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询全部的考试成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><span class="hljs-comment">-- 查询哪些同学参加了考试</span><br><span class="hljs-keyword">SELECT</span> `StudentNo` <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><span class="hljs-comment">-- 发现重复数据，去重</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> `StudentNo` <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br></code></pre></td></tr></table></figure>

<p>数据库中的表达式：文本值，列，Null，函数，计算表达式，系统变量…</p>
<h3 id="where条件子句"><a href="#where条件子句" class="headerlink" title="where条件子句"></a>where条件子句</h3><p>作用：检索数据中符合条件的值</p>
<blockquote>
<p>逻辑运算符</p>
</blockquote>
<table>
<thead>
<tr>
<th>运算符</th>
<th>语法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>and    &amp;&amp;</td>
<td>a and b          a&amp;&amp;b</td>
<td>逻辑与，两个都为真，结果为真</td>
</tr>
<tr>
<td>or  ||</td>
<td>a or b            a || b</td>
<td>逻辑或，其中一个为真，则结果为真</td>
</tr>
<tr>
<td>Not    !</td>
<td>not a               !a</td>
<td>逻辑非，真为假，假为真</td>
</tr>
</tbody></table>
<blockquote>
<p>模糊查询</p>
</blockquote>
<table>
<thead>
<tr>
<th>运算符</th>
<th>语法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>IS NULL</td>
<td>a is null</td>
<td>如果操作符为NULL，结果为真</td>
</tr>
<tr>
<td>IS NOT NULL</td>
<td>a is not null</td>
<td>如果操作符不为null，结果为真</td>
</tr>
<tr>
<td>BETWEEN</td>
<td>a between b and c</td>
<td>若a在b和c之间，则结果为真</td>
</tr>
<tr>
<td><strong>Like</strong></td>
<td>a like b</td>
<td>SQL匹配，如果a匹配b，则结果为真</td>
</tr>
<tr>
<td><strong>In</strong></td>
<td>a in (a1,a2,a3)</td>
<td>假设a在a1，或者a2…其中的某一个值中，结果为真</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询姓刘的同学</span><br><span class="hljs-comment">-- like结合	%(代表0到任意个字符)	_(代表一个字符)</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> StudentName <span class="hljs-keyword">LIKE</span> `刘<span class="hljs-operator">%</span>`;<br><br><span class="hljs-comment">-- 查询姓刘的同学，名字后面只有一个字的</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> StudentName <span class="hljs-keyword">LIKE</span> `刘_`;<br><br><span class="hljs-comment">-- 查询名字中间有嘉字的同学 %嘉%</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> StudentName <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%嘉%&#x27;</span>;<br><br><span class="hljs-comment">-- in</span><br><span class="hljs-comment">-- 查询1001，1002，1003号学员</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`, `StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> StudentNo <span class="hljs-keyword">IN</span> (<span class="hljs-number">1001</span>,<span class="hljs-number">1002</span>,<span class="hljs-number">1003</span>);<br><br><span class="hljs-comment">-- 查询在北京的学生</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> `Address` <span class="hljs-keyword">IN</span> (<span class="hljs-string">&#x27;安徽&#x27;</span>,<span class="hljs-string">&#x27;河南洛阳&#x27;</span>);<br><br><span class="hljs-comment">-- 查询地址为空的学生</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> address<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">OR</span> address <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span><br><br><span class="hljs-comment">-- 查询有出生日期的同学</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`StudentName` <span class="hljs-keyword">FROM</span> `student`<br><span class="hljs-keyword">WHERE</span> `BornDate` <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br></code></pre></td></tr></table></figure>

<h3 id="联表查询"><a href="#联表查询" class="headerlink" title="联表查询"></a>联表查询</h3><blockquote>
<p>Join</p>
</blockquote>
<p><img src="/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/20181103160140252.png" srcset="/img/loading.gif" lazyload alt="联表查询"></p>
<p>MySQL不支持full outer join</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> s.studentNO,studentName,SubjectNo,StudentResult<br><span class="hljs-keyword">FROM</span> student <span class="hljs-keyword">AS</span> s <span class="hljs-comment">-- AS 可以省略</span><br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">result</span> <span class="hljs-keyword">AS</span> r<br><span class="hljs-keyword">WHERE</span> s.studentNO <span class="hljs-operator">=</span> r.studentNO;<br><br><span class="hljs-comment">-- Right Join</span><br><span class="hljs-keyword">SELECT</span> s.studentNO,studentName,SubjectNo,StudentResult<br><span class="hljs-keyword">FROM</span> student s<br><span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">result</span> r<br><span class="hljs-keyword">ON</span> s.studentNO <span class="hljs-operator">=</span> r.studentNO; <span class="hljs-comment">-- 可以用on</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>自连接</p>
</blockquote>
<p>自己的表和自己的表连接</p>
<h3 id="分页和排序"><a href="#分页和排序" class="headerlink" title="分页和排序"></a>分页和排序</h3><blockquote>
<p>排序</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 排序：升序asc, 降序desc</span><br><span class="hljs-comment">-- ORDER BY 通过哪个字段排序，怎么排</span><br><span class="hljs-comment">-- 查询的结果根据 成绩降序 排序</span><br><span class="hljs-keyword">SELECT</span> s.`StudentNo`, `StudentName`, `SubjectName`, `SubjectResult`<br><span class="hljs-keyword">FROM</span> student s<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `<span class="hljs-keyword">result</span>` r<br><span class="hljs-keyword">ON</span> s.StudentNo <span class="hljs-operator">=</span> r.StudentNo<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `subject` sub<br><span class="hljs-keyword">ON</span> r.`SubjectNo` <span class="hljs-operator">=</span> sub.`SubjectNo`<br><span class="hljs-keyword">WHERE</span> subjectName <span class="hljs-operator">=</span> `数据结构<span class="hljs-number">-1</span>`<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> StudentResult <span class="hljs-keyword">ASC</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>分页</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 分页</span><br><span class="hljs-comment">-- 语法：limit 起始值/偏移量，页面的大小</span><br><span class="hljs-keyword">SELECT</span> s.`StudentNo`, `StudentName`, `SubjectName`, `SubjectResult`<br><span class="hljs-keyword">FROM</span> student s<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `<span class="hljs-keyword">result</span>` r<br><span class="hljs-keyword">ON</span> s.StudentNo <span class="hljs-operator">=</span> r.StudentNo<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `subject` sub<br><span class="hljs-keyword">ON</span> r.`SubjectNo` <span class="hljs-operator">=</span> sub.`SubjectNo`<br><span class="hljs-keyword">WHERE</span> subjectName <span class="hljs-operator">=</span> `数据结构<span class="hljs-number">-1</span>`<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> StudentResult <span class="hljs-keyword">ASC</span><br>LIMIT <span class="hljs-number">0</span>,<span class="hljs-number">5</span><br><br><span class="hljs-comment">-- 第一页 limit 0,5    (1-1)*5</span><br><span class="hljs-comment">-- 第二页 limit 5,5    (2-1)*5</span><br><span class="hljs-comment">-- 第三页 limit 10,5	(3-1)*5</span><br><span class="hljs-comment">-- 第N页  limit        (n-1)*pageSize,pageSize</span><br><span class="hljs-comment">-- 【pageSize：页面大小】</span><br><span class="hljs-comment">-- 【(n-1)*pageSize：起始值】</span><br><span class="hljs-comment">-- 【n：当前页】</span><br><span class="hljs-comment">-- 【数据总数/页面大小 = 总页数】</span><br></code></pre></td></tr></table></figure>

<p>语法：<code>limit(查询起始下标，pageSize)</code></p>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>本质：在where语句中嵌套一个子查询语句</p>
<p>where (select * from …)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询 数据库结构-1 的所有考试结果（学号，科目编号，成绩），降序排列</span><br><span class="hljs-comment">-- 方式一：使用连接查询</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,r.`SubjectNo`,`StudentResult`<br><span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">result</span>` r<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `subject` sub<br><span class="hljs-keyword">ON</span> r.SubjectNo <span class="hljs-operator">=</span> sub.SubjectNo<br><span class="hljs-keyword">WHERE</span> SubjectName <span class="hljs-operator">=</span> `数据库结构<span class="hljs-number">-1</span>`<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> StudentResult <span class="hljs-keyword">DESC</span><br><br><span class="hljs-comment">-- 方式二：使用子查询</span><br><span class="hljs-keyword">SELECT</span> `StudentNo`,`SubjectNo`,`StudentResult`<br><span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">result</span>`<br><span class="hljs-keyword">WHERE</span> SubjectNo <span class="hljs-operator">=</span> (<br>	<span class="hljs-keyword">SELECT</span> SubjectNo <span class="hljs-keyword">FROM</span> `subject`<br>    <span class="hljs-keyword">WHERE</span> SubjectName <span class="hljs-operator">=</span> `数据库结构<span class="hljs-number">-1</span>`<br>)<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> StudentResult <span class="hljs-keyword">DESC</span><br></code></pre></td></tr></table></figure>

<h2 id="4-MySQL函数"><a href="#4-MySQL函数" class="headerlink" title="4.MySQL函数"></a>4.MySQL函数</h2><h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 数学运算</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">ABS</span>(<span class="hljs-number">-8</span>) <span class="hljs-comment">-- 绝对值</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CEILING</span>(<span class="hljs-number">9.4</span>) <span class="hljs-comment">-- 向上取整</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">9.4</span>) <span class="hljs-comment">-- 向下取整</span><br><span class="hljs-keyword">SELECT</span> RAND() <span class="hljs-comment">-- 返回一个0~1之间的随机数</span><br><span class="hljs-keyword">SELECT</span> SIGN(<span class="hljs-number">-10</span>) <span class="hljs-comment">-- 判断一个数的符号 0-0 负数返回-1，正数返回1</span><br><br><span class="hljs-comment">-- 字符串函数</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-string">&#x27;即使再小的帆也能远航&#x27;</span>) <span class="hljs-comment">-- 字符串长度</span><br><span class="hljs-keyword">SELECT</span> CONCAT(<span class="hljs-string">&#x27;我&#x27;</span>,<span class="hljs-string">&#x27;爱&#x27;</span>,<span class="hljs-string">&#x27;coding&#x27;</span>) <span class="hljs-comment">-- 拼接字符串</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">INSERT</span>(<span class="hljs-string">&#x27;我爱coding&#x27;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,&quot;热爱&quot;) <span class="hljs-comment">-- 查询，替换</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">LOWER</span>(<span class="hljs-string">&#x27;CZh&#x27;</span>) <span class="hljs-comment">-- 小写</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">UPPER</span>(<span class="hljs-string">&#x27;CZh&#x27;</span>) <span class="hljs-comment">-- 大写</span><br><span class="hljs-keyword">SELECT</span> INSTR(<span class="hljs-string">&#x27;CZh&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>) <span class="hljs-comment">-- 返回第一次出现的子串的索引</span><br><span class="hljs-keyword">SELECT</span> REPLACE(<span class="hljs-string">&#x27;坚持就能成功&#x27;</span>,<span class="hljs-string">&#x27;坚持&#x27;</span>,<span class="hljs-string">&#x27;努力&#x27;</span>) <span class="hljs-comment">-- 替换出现的指定字符串</span><br><span class="hljs-keyword">SELECT</span> SUBSTR(<span class="hljs-string">&#x27;坚持就能成功&#x27;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>) <span class="hljs-comment">-- 返回指定的子字符串(源字符串，截取的位置，截取的长度)</span><br><span class="hljs-keyword">SELECT</span> REVERSE(<span class="hljs-string">&#x27;坚持就能成功&#x27;</span>) <span class="hljs-comment">-- 反转</span><br><br><span class="hljs-comment">-- 时间和日期函数（记住）</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_DATE</span>() <span class="hljs-comment">-- 获取当前日期</span><br><span class="hljs-keyword">SELECT</span> CURDATE() <span class="hljs-comment">-- 获取当前日期</span><br><span class="hljs-keyword">SELECT</span> NOW() <span class="hljs-comment">-- 获取当前时间</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">LOCALTIME</span>() <span class="hljs-comment">-- 本地时间</span><br><span class="hljs-keyword">SELECT</span> SYSDATE() <span class="hljs-comment">-- 系统时间</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">YEAR</span>(NOW())<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MONTH</span>(NOW())<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DAY</span>(NOW())<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">HOUR</span>(NOW())<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MINUTE</span>(NOW())<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SECOND</span>(NOW())<br><br><span class="hljs-comment">-- 系统</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SYSTEM_USER</span>()<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">USER</span>()<br><span class="hljs-keyword">SELECT</span> VERSION()<br></code></pre></td></tr></table></figure>

<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><table>
<thead>
<tr>
<th>函数名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>COUNT()</td>
<td>计数</td>
</tr>
<tr>
<td>SUM()</td>
<td>求和</td>
</tr>
<tr>
<td>AVG()</td>
<td>平均值</td>
</tr>
<tr>
<td>MAX()</td>
<td>最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>最小值</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(studentname) <span class="hljs-keyword">FROM</span> student; <span class="hljs-comment">-- Count(指定列)，会忽略所有的null值</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> student; <span class="hljs-comment">-- Count(*)，不会忽略null值</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span>;  <span class="hljs-comment">-- Count(1)，不会忽略所有的null值，本质：计算行数</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(`StudentResult`) <span class="hljs-keyword">AS</span> 总和 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(`StudentResult`) <span class="hljs-keyword">AS</span> 平均分 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(`StudentResult`) <span class="hljs-keyword">AS</span> 最高分 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(`StudentResult`) <span class="hljs-keyword">AS</span> 最低分 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span><br><br><span class="hljs-comment">-- 查询不同课程的平均分，最高分，最低分，平均分大于80</span><br><span class="hljs-comment">-- 核心：根据不同的课程分组</span><br><span class="hljs-keyword">SELECT</span> SubjectName,<span class="hljs-built_in">AVG</span>(StudentResult) <span class="hljs-keyword">AS</span> 平均分,<span class="hljs-built_in">MAX</span>(StudentResult) <span class="hljs-keyword">AS</span> 最高分,<span class="hljs-built_in">MIN</span>(StudentResult) <span class="hljs-keyword">AS</span> 最低分<br><span class="hljs-keyword">FROM</span> <span class="hljs-keyword">result</span> r<br><span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `suject` sub<br><span class="hljs-keyword">ON</span> r.`SubjectNo` <span class="hljs-operator">=</span> sub.`SubjectNo`<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> r.SubjectNo <span class="hljs-comment">-- 通过什么字段来分组</span><br><span class="hljs-keyword">HAVING</span> 平均分<span class="hljs-operator">&gt;</span><span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<h3 id="数据库级别的MD5加密"><a href="#数据库级别的MD5加密" class="headerlink" title="数据库级别的MD5加密"></a>数据库级别的MD5加密</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 加密</span><br><span class="hljs-keyword">UPDATE</span> testmd5 <span class="hljs-keyword">SET</span> pwd<span class="hljs-operator">=</span>MD5(pwd) <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">UPDATE</span> testmd5 <span class="hljs-keyword">SET</span> pwd<span class="hljs-operator">=</span>MD5(pwd) <span class="hljs-comment">-- 加密全部的密码</span><br><br><span class="hljs-comment">-- 插入的时候加密</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> testmd5 <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;xiaoming&#x27;</span>, MD5(<span class="hljs-string">&#x27;123456&#x27;</span>))<br><br><span class="hljs-comment">-- 如何校验：将用户传递进来的密码，进行md5加密，然后对比加密后的值</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> testmd5 <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;xiaoming&#x27;</span> <span class="hljs-keyword">AND</span> pwd<span class="hljs-operator">=</span>MD5(<span class="hljs-string">&#x27;123456&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="5-事务"><a href="#5-事务" class="headerlink" title="5.事务"></a>5.事务</h2><blockquote>
<p>事务原则：ACID原则 原子性、一致性、隔离性、持久性</p>
</blockquote>
<p><strong>原子性（Atomicity）</strong></p>
<p>要么都成功，要么都失败</p>
<p><strong>一致性（Consistency）</strong></p>
<p>事务前后的数据完整性要保持一致</p>
<p><strong>隔离性（Isolation）</strong></p>
<p>事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰</p>
<p><strong>持久性（Durability）</strong></p>
<p>事务一旦提交则不可逆，被持久化到数据库中</p>
<blockquote>
<p>隔离所导致的一些问题</p>
</blockquote>
<p><strong>脏读：</strong></p>
<p>指一个事务读取了另一个事务未提交的数据。</p>
<p><strong>不可重复读：</strong></p>
<p>在一个事务内读取表中的某一行数据，多次读取结果不同。</p>
<p><strong>虚读（幻读）：</strong></p>
<p>是指在一个事务内读取到了别的事务插入的数据，导致前后读取不一致。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- MySQL默认开启事务自动提交</span><br><span class="hljs-keyword">SET</span> autocommit <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-comment">/* 关闭 */</span><br><span class="hljs-keyword">SET</span> autocommit <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-comment">/* 开启（默认的）*/</span><br><br><span class="hljs-comment">-- 手动处理事务</span><br><br><span class="hljs-comment">-- 事务开启</span><br><span class="hljs-keyword">START</span> TRANSACTION <span class="hljs-comment">-- 标记一个事务的开始，从这个之后的sql都在同一个事务内</span><br><br><span class="hljs-comment">-- 提交：持久化，数据已提交就不能回滚了</span><br><span class="hljs-keyword">COMMIT</span><br><span class="hljs-comment">-- 回滚：回到原来的样子</span><br><span class="hljs-keyword">ROLLBACK</span><br><br><span class="hljs-comment">-- 事务结束</span><br><br><br><span class="hljs-keyword">SAVEPOINT</span> 保存点名  <span class="hljs-comment">-- 设置一个事务的保存点</span><br><span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TO</span> <span class="hljs-keyword">SAVEPOINT</span> 保存点名 <span class="hljs-comment">-- 回滚到保存点</span><br><span class="hljs-keyword">RELEASE</span> <span class="hljs-keyword">SAVEPOINT</span> 保存点名 <span class="hljs-comment">-- 释放保存点</span><br></code></pre></td></tr></table></figure>

<h2 id="6-索引"><a href="#6-索引" class="headerlink" title="6.索引"></a>6.索引</h2><blockquote>
<p>MySQL官方对索引的定义为：<strong>索引（index）是帮助MySQL高效获取数据的数据结构。</strong></p>
<p>提取句子主干，就可以得到索引的本质：<strong>索引是数据结构</strong></p>
</blockquote>
<h3 id="索引的分类"><a href="#索引的分类" class="headerlink" title="索引的分类"></a>索引的分类</h3><ul>
<li>主键索引（PRIMARY KEY）<ul>
<li>唯一的标识，主键不可重复，只能有一个列作为主键</li>
</ul>
</li>
<li>唯一索引（UNIQUE KEY）<ul>
<li>索引列的值必须唯一，唯一索引可以重复，多个列都可以标识为唯一索引</li>
</ul>
</li>
<li>普通索引（KEY&#x2F;INDEX）<ul>
<li>默认的，index，key关键字来设置</li>
</ul>
</li>
<li>全文索引（FullText）<ul>
<li>在特定的数据库引擎下才有，如MyISAM</li>
<li>快速定位数据</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 索引的使用</span><br><span class="hljs-comment">-- 1.在创建表的时候给字段增加索引</span><br><span class="hljs-comment">-- 2.创建完毕后，增加索引</span><br><br><span class="hljs-comment">-- 显示所有的索引信息</span><br><span class="hljs-keyword">SHOW</span> INDEX <span class="hljs-keyword">FROM</span> student<br><br><span class="hljs-comment">-- 增加一个全文索引（索引名）列名</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> school.student <span class="hljs-keyword">ADD</span> FULLTEXT INDEX `studentName`(`studentName`);<br><br><span class="hljs-comment">-- EXPLAIN分析sql执行的状况</span><br>EXPLAIN <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> student; <span class="hljs-comment">-- 非全文索引</span><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>测试索引</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 插入100万条数据</span><br>DELIMITER $$ <span class="hljs-comment">-- 写函数前必须要写</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> mock_data()<br><span class="hljs-keyword">RETURNS</span> <span class="hljs-type">INT</span><br><span class="hljs-keyword">BEGIN</span><br>	<span class="hljs-keyword">DECLARE</span> num <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">1000000</span>;<br>	<span class="hljs-keyword">DECLARE</span> i <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;<br>	<br>	<span class="hljs-keyword">WHERE</span> i<span class="hljs-operator">&lt;</span>num DO<br>		<span class="hljs-comment">-- 插入语句</span><br>		<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span>...<br>		<span class="hljs-keyword">SET</span> i <span class="hljs-operator">=</span> i <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">END</span> WHILE<br><span class="hljs-keyword">END</span>;<br><span class="hljs-keyword">SELECT</span> mock_data()<br></code></pre></td></tr></table></figure>

<h3 id="索引原则"><a href="#索引原则" class="headerlink" title="索引原则"></a>索引原则</h3><ul>
<li>索引不是越多越好</li>
<li>不要对经常变动的数据加索引</li>
<li>小数据量的表不需要加索引</li>
<li>索引一般加在常用来查询的字段上</li>
</ul>
<blockquote>
<p>索引的数据结构</p>
</blockquote>
<p>Btree：InnoDB的默认数据结构</p>
<p><a target="_blank" rel="noopener" href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">CodingLabs - MySQL索引背后的数据结构及算法原理</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/113917726">深入理解 Mysql 索引底层原理 - 知乎 (zhihu.com)</a></p>
<p>索引最终选择B+树的原因:</p>
<ol>
<li><p>hash很快，但每次IO只能取一个数</p>
</li>
<li><p>AVL和红黑树，在大量数据的情况下，IO操作还是太多</p>
</li>
<li><p>B树每个节点内存储的是数据，因此每个节点存储的分支太少</p>
</li>
<li><p>B+节点存储的是索引+指针(引用指向下一个节点)，可以存储大量索引，同时最终数据存储在叶子节点，并且有引用横向链接，可以在2-3次的IO操作内完成千万级别的表操作。</p>
</li>
<li><p>建议索引是是自增长数字，这样适合范围查找</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/fa8192853184">聚簇索引与非聚簇索引（也叫二级索引） - 简书 (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mffandxx/article/details/111916252">索引知识系列二：联合索引、索引覆盖和索引下推详解_程序编织梦想的博客-CSDN博客_索引覆盖和索引下推</a></p>
<h2 id="权限管理和备份"><a href="#权限管理和备份" class="headerlink" title="权限管理和备份"></a>权限管理和备份</h2><h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建用户</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> 用户名 IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;密码&#x27;</span>;<br><br><span class="hljs-comment">-- 修改密码（修改当前用户密码）</span><br><span class="hljs-keyword">SET</span> PASSWORD <span class="hljs-operator">=</span> PASSWORD(<span class="hljs-string">&#x27;123456&#x27;</span>);<br><br><span class="hljs-comment">-- 修改密码（修改指定用户密码）</span><br><span class="hljs-keyword">SET</span> PASSWORD <span class="hljs-keyword">FOR</span> 用户名 <span class="hljs-operator">=</span> PASSWORD(<span class="hljs-string">&#x27;123456&#x27;</span>)<br><br><span class="hljs-comment">-- 重命名</span><br>RENAME <span class="hljs-keyword">USER</span> 原名 <span class="hljs-keyword">TO</span> 新名字<br><br><span class="hljs-comment">-- 用户授权</span><br><span class="hljs-comment">-- ALL PRIVILEGES除了给别人授权，其他都能干</span><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> 用户名<br><br><span class="hljs-comment">-- 查询权限</span><br><span class="hljs-keyword">SHOW</span> GRANTS <span class="hljs-keyword">FOR</span> 用户名 <span class="hljs-comment">-- 查看指定用户的权限</span><br><br><span class="hljs-comment">-- 撤销权限</span><br><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> 用户名<br><br></code></pre></td></tr></table></figure>

<h3 id="MySQL备份"><a href="#MySQL备份" class="headerlink" title="MySQL备份"></a>MySQL备份</h3><p>命令行导出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"># mysqldump <span class="hljs-operator">-</span>h 主机 <span class="hljs-operator">-</span>u 用户名 <span class="hljs-operator">-</span>p 密码 数据库 表名 <span class="hljs-operator">&gt;</span> 物理磁盘位置<br>mysqldump <span class="hljs-operator">-</span>hlocalhost <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p123456 school student <span class="hljs-operator">&gt;</span>D:<span class="hljs-operator">/</span>a.sql<br><br># 导入<br># 登录的情况下，切换到指定的数据库<br>source d:<span class="hljs-operator">/</span>a.sql<br><br></code></pre></td></tr></table></figure>



<h2 id="数据库的归约，三大范式"><a href="#数据库的归约，三大范式" class="headerlink" title="数据库的归约，三大范式"></a>数据库的归约，三大范式</h2><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h2 id="EXPLAIN"><a href="#EXPLAIN" class="headerlink" title="EXPLAIN"></a>EXPLAIN</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/explain-output.html">MySQL ：： MySQL 5.7 参考手册 ：： 8.8.2 EXPLAIN 输出格式</a></p>
<blockquote>
<p>使用EXPLAIN关键字可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。分析你的查询语句或表结构的性能瓶颈。</p>
</blockquote>
<p>用法：explain + sql语句</p>
<p>能够知道：</p>
<ul>
<li>表的读取顺序</li>
<li>数据读取操作的操作类型</li>
<li>哪些索引可以被使用</li>
<li>哪些索引被实际使用</li>
<li>表之间的引用</li>
<li>每张表有多少行被优化器查询</li>
</ul>
<p>表包含的字段如下：</p>
<p><img src="/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/image-20210715114955960.png" srcset="/img/loading.gif" lazyload alt="explain输出字段"></p>
<h3 id="id"><a href="#id" class="headerlink" title="id"></a>id</h3><blockquote>
<p>select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序</p>
</blockquote>
<p>三种情况：</p>
<ul>
<li>id相同，执行顺序由上至下</li>
<li>id不同，如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行。</li>
<li>id相同与不同同时存在，id相同的从上往下循序执行，id越大，优先级越高，越先执行。</li>
</ul>
<h3 id="select-type"><a href="#select-type" class="headerlink" title="select_type"></a>select_type</h3><ul>
<li><strong>SIMPLE</strong>：简单的select查询，查询中不包含子查询或者UNION。</li>
<li><strong>PRIMARY</strong>：查询中若包含任何复杂的子查询，最外层查询则标记为PRIMARY。</li>
<li><strong>SUBQUERY</strong>：在select或where列表中包含的子查询。</li>
<li><strong>DERIVED</strong>：在FROM列表中包含的子查询被标记为DERIVED(衍生)，MySQL会递归执行这些子查询，把结果放在临时表里。</li>
<li><strong>UNION</strong>：若第二个SELECT出现在UNION之后，则被标记为UNION；若UNION包含在FROM子句的子查询中，外层SELECT将被标记为：DERIVED。</li>
<li><strong>UNION RESULT</strong>：从UNION表获取结果的SELECT。</li>
</ul>
<h3 id="table"><a href="#table" class="headerlink" title="table"></a>table</h3><p>显示这一行的数据是关于哪张表的</p>
<h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><p>访问类型排列</p>
<p>显示查询使用了何种类型</p>
<p><font color='FF0000'>从最好到最差依次是：</font></p>
<p>system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</p>
<p>简化如下：</p>
<p>system-&gt;const-&gt;eq_ref&gt;ref&gt;range&gt;index&gt;ALL</p>
<ul>
<li><p><strong>system</strong>：表只有一行记录（等于系统表），这是const类型的特例，平时不会出现，可忽略不计</p>
</li>
<li><p><strong>const</strong>：表示通过索引一次就找到了，const用于比较primary key或者unique索引。因为只匹配一行数据，所以很快。如将主键置于where列表中，MySQL就能将该查询转换为一个常量。</p>
</li>
<li><p><strong>eq_ref</strong>：唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或唯一索引扫描。</p>
</li>
<li></li>
</ul>
<h3 id="possible-keys"><a href="#possible-keys" class="headerlink" title="possible_keys"></a>possible_keys</h3><p>提示使用哪个索引会在该表中找到行，不太重要</p>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>MYSQL使用的索引，简单且重要</p>
<h3 id="key-len"><a href="#key-len" class="headerlink" title="key_len"></a>key_len</h3><p>MYSQL使用的索引长度</p>
<h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><p>ref列显示使用哪个列或常数与key一起从表中选择行。</p>
<h3 id="rows"><a href="#rows" class="headerlink" title="rows"></a>rows</h3><p>显示MYSQL执行查询的行数，简单且重要，数值越大越不好，说明没有用好索引</p>
<h3 id="filtered"><a href="#filtered" class="headerlink" title="filtered"></a>filtered</h3><p>按表条件筛选的行的百分比</p>
<h3 id="Extra"><a href="#Extra" class="headerlink" title="Extra"></a>Extra</h3><p>该列包含MySQL解决查询的详细信息。</p>
<h2 id="MVCC-多版本并发控制"><a href="#MVCC-多版本并发控制" class="headerlink" title="MVCC(多版本并发控制)"></a>MVCC(多版本并发控制)</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/innodb-multi-versioning.html">MySQL ：： MySQL 8.0 参考手册 ：： 15.3 InnoDB 多版本控制</a>（官方文档，推荐）</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/654773e14c38">Mysql中的MVCC - 简书 (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Tomwildboar/article/details/121064240">MySQL，MVCC详解，快照读在RC、RR下的区别_小道仙97的博客-CSDN博客_mysql rc 快照读</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/JFjFs_7xduCmHOegbJ-Gbg">招银面试官，听说你精通 MySQL，我们来大战 66 回合 (qq.com)</a>（有某些错误）</p>
<h2 id="char与varchar的区别"><a href="#char与varchar的区别" class="headerlink" title="char与varchar的区别"></a>char与varchar的区别</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bigwood99/article/details/114981705">闲谈MySQL的char和varchar</a></p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/char.html">MySQL :: MySQL 8.0 Reference Manual :: 11.3.2 The CHAR and VARCHAR Types</a></p>
<h3 id="char"><a href="#char" class="headerlink" title="char"></a>char</h3><ul>
<li>char 表示定长字符串，长度是固定的；</li>
<li>如果插入数据的长度小于 char 的固定长度时，则用空格填充；</li>
<li>因为长度固定，所以存取速度要比 varchar 快很多，甚至能快 50%，但正因为其长度固定，所以会占据多余的空间，是空间换时间的做法；</li>
<li>对于 char 来说，最多能存放的字符个数为 255，和编码无关</li>
</ul>
<h3 id="varchar"><a href="#varchar" class="headerlink" title="varchar"></a>varchar</h3><ul>
<li>varchar 表示可变长字符串，长度是可变的；</li>
<li>插入的数据是多长，就按照多长来存储；</li>
<li>varchar 在存取方面与 char 相反，它存取慢，因为长度不固定，但正因如此，不占据多余的空间，是时间换空间的做法；</li>
<li>对于 varchar 来说，最多能存放的字符个数为 65535 ，但这个值是理论值，实际比这个少，因为字符开头会使用1-2个字节记录字符串长度</li>
</ul>
<h3 id="重要"><a href="#重要" class="headerlink" title="重要"></a><strong>重要</strong></h3><p>一般认为，char是定长字符，varchar是可变长度字符。</p>
<p>在MySQL版本4.12以后，这种说法就不完全正确了。在4.12版之后，char(n)中的n代表的不再是字节长度，而是字符长度。在这个改变下，如果字符集选择的是多字节字符集，比如utf-8，那么char(n)则存储的数据就不是固定长度了。</p>
<p>例如，char(3)可以存储“abc”、“一二三”。显然，前面两个字符串的字节长度是不一样的。</p>
<p>所以只有当字符集选择了单字节字符集，比如latin1，char是固定长度。在使用多字节字符集时，char则被当作vachar类型。</p>
<p>这一问题是很多程序员容易忽略的。</p>
<p>另一个容易忽略的问题是varchar最大能存储多长字节。官方资料显示是65536，但是如果你定义一个varchar长度65535是会报错的。</p>
<p>实际测试，最大值是65532。这里又隐藏了一个问题，如果字符集是utf-8，定义varchar(65532)还是会报错的。因为varchar(n)中的n指的是字符长度。</p>
<p>日常的设计，对于长度相对固定的字符串，可以使用 char，对于长度不确定的，使用 varchar 更合适一些。</p>
<h2 id="blob-和-text-有什么区别"><a href="#blob-和-text-有什么区别" class="headerlink" title="blob 和 text 有什么区别"></a>blob 和 text 有什么区别</h2><ul>
<li>blob 用于存储二进制数据，而 text 用于存储大字符串。</li>
<li>blob 没有字符集，text 有一个字符集，并且根据字符集的校对规则对值进行排序和比较</li>
</ul>
<h2 id="DATETIME-和-TIMESTAMP-的异同"><a href="#DATETIME-和-TIMESTAMP-的异同" class="headerlink" title="DATETIME 和 TIMESTAMP 的异同"></a>DATETIME 和 TIMESTAMP 的异同</h2><p><strong>相同点</strong>：</p>
<ol>
<li>两个数据类型存储时间的表现格式一致。均为 <code>YYYY-MM-DD HH:MM:SS</code></li>
<li>两个数据类型都包含「日期」和「时间」部分。</li>
<li>两个数据类型都可以存储微秒的小数秒（秒后 6 位小数秒）</li>
</ol>
<p><strong>区别</strong>：</p>
<ol>
<li><p><strong>日期范围</strong>：DATETIME 的日期范围是 <code>1000-01-01 00:00:00.000000</code> 到 <code>9999-12-31 23:59:59.999999</code>；TIMESTAMP 的时间范围是<code>1970-01-01 00:00:01.000000</code> UTC <code>到 ``2038-01-09 03:14:07.999999</code> UTC</p>
</li>
<li><p><strong>存储空间</strong>：在5.6.4之前，datetime存储占用8个字节，而timestamp是占用4字节；但是在5.6.4之后，由于这两个类型允许有小数部分，所以占用的存储空间和以前不同；MySQL规范规定，datetime的非小数部分需要5个字节，而不是8个字节，而timestamp的非小数部分是需要4个字节，并且这两个部分的小数部分都需要0到3个字节，具体取决于存储值的小数秒精度。</p>
</li>
<li><p><strong>时区相关</strong>：DATETIME 存储时间与时区无关；TIMESTAMP 存储时间与时区有关，显示的值也依赖于时区</p>
</li>
<li><p><strong>默认值</strong>：DATETIME 的默认值为 null；TIMESTAMP 的字段默认不为空(not null)，默认值为当前时间(CURRENT_TIMESTAMP)</p>
</li>
</ol>
<h2 id="MySQL-中-in-和-exists-的区别"><a href="#MySQL-中-in-和-exists-的区别" class="headerlink" title="MySQL 中 in 和 exists 的区别"></a>MySQL 中 in 和 exists 的区别</h2><p>MySQL 中的 in 语句是把外表和内表作 hash 连接，而 exists 语句是对外表作 loop 循环，每次 loop 循环再对内表进行查询。我们可能认为 exists 比 in 语句的效率要高，这种说法其实是不准确的，要区分情景：</p>
<ol>
<li>如果查询的两个表大小相当，那么用 in 和 exists 差别不大。</li>
<li>如果两个表中一个较小，一个是大表，则子查询表大的用 exists，子查询表小的用 in。</li>
<li>not in 和 not exists：如果查询语句使用了 not in，那么内外表都进行全表扫描，没有用到索引；而 not extsts 的子查询依然能用到表上的索引。所以无论那个表大，用 not exists 都比 not in 要快。</li>
</ol>
<h2 id="drop、truncate和delete的区别"><a href="#drop、truncate和delete的区别" class="headerlink" title="drop、truncate和delete的区别"></a>drop、truncate和delete的区别</h2><table>
<thead>
<tr>
<th>区别点</th>
<th>drop</th>
<th>truncate</th>
<th>delete</th>
</tr>
</thead>
<tbody><tr>
<td>执行速度</td>
<td>快</td>
<td>较快</td>
<td>慢</td>
</tr>
<tr>
<td>命令分类</td>
<td>DDL（数据定义语言）</td>
<td>DDL（数据定义语言）</td>
<td>DML（数据操作语言）</td>
</tr>
<tr>
<td>删除对象</td>
<td><strong>删除整张表和表结构</strong>，以及表的索引、约束和触发器。</td>
<td><strong>只删除表数据</strong>，表的结构、索引、约束等会被保留。</td>
<td><strong>只删除表的全部或部分数据</strong>，表结构、索引、约束等会被保留。</td>
</tr>
<tr>
<td>删除条件（where）</td>
<td>不能用</td>
<td>不能用</td>
<td>可使用</td>
</tr>
<tr>
<td>回滚</td>
<td>不可回滚</td>
<td>不可回滚</td>
<td>可回滚</td>
</tr>
<tr>
<td>自增初始值</td>
<td>-</td>
<td>重置</td>
<td>不重置</td>
</tr>
</tbody></table>
<h2 id="count-1-、count-与-count-列名-的区别"><a href="#count-1-、count-与-count-列名-的区别" class="headerlink" title="count(1)、count(*) 与 count(列名) 的区别"></a>count(1)、count(*) 与 count(列名) 的区别</h2><p><strong>执行效果</strong>：</p>
<ul>
<li>count(*)包括了所有的列，相当于行数，在统计结果的时候，不会忽略列值为 NULL</li>
<li>count(1)包括了忽略所有列，用 1 代表代码行，在统计结果的时候，不会忽略列值为 NULL</li>
<li>count(列名)只包括列名那一列，在统计结果的时候，会忽略列值为空（这里的空不是只空字符串或者 0，而是表示 null）的计数，即某个字段值为 NULL 时，不统计。</li>
</ul>
<p><strong>执行速度</strong>：</p>
<ul>
<li>列名为主键，count(列名)会比 count(1)快</li>
<li>列名不为主键，count(1)会比 count(列名)快</li>
<li>如果表多个列并且没有主键，则 count（1） 的执行效率优于 count（*）</li>
<li>如果有主键，则 select count（主键）的执行效率是最优的</li>
<li>如果表只有一个字段，则 select count（*）最优。</li>
</ul>
<h2 id="B-树"><a href="#B-树" class="headerlink" title="B+树"></a>B+树</h2><p><img src="/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/image-20220902113957460.png" srcset="/img/loading.gif" lazyload alt="B+树"></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/juniorMa/p/13589501.html">InnoDb页结构 - MaXianZhe - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MAYHENG/article/details/106575604">Mysql数据读取方式以及InnoDb页存储</a></p>
<h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41814871/article/details/124996364">一文详解脏读、不可重复读、幻读</a></p>
<p><img src="/2021/08/06/MySQL%E5%9F%BA%E7%A1%80/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB.png" srcset="/img/loading.gif" lazyload alt="事务隔离级别"></p>
<p>在RR级别下面不会产生 不可重复读，之所以不会产生 不可重复读，是快照读在RC和RR下的生成的策略不一样。</p>
<p>RC隔离级别下，是每个快照读都会生成并获取最新的Read View；而在RR隔离级别下，则是同一个事务中的第一个快照读才会创建Read View, 之后的快照读获取的都是同一个Read View。</p>
<h2 id="MySQL模糊查询再也用不着-like-了！"><a href="#MySQL模糊查询再也用不着-like-了！" class="headerlink" title="MySQL模糊查询再也用不着 like+% 了！"></a><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ScJAgUkLHGpmTDS9KlZDBA">MySQL模糊查询再也用不着 like+% 了！</a></h2><h2 id="聚簇索引与非聚簇索引（也叫二级索引）"><a href="#聚簇索引与非聚簇索引（也叫二级索引）" class="headerlink" title="聚簇索引与非聚簇索引（也叫二级索引）"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/fa8192853184">聚簇索引与非聚簇索引（也叫二级索引）</a></h2><h2 id="索引知识系列二：联合索引、覆盖索引（covering-index）和索引条件下推（index-condition-pushdown-icp）详解"><a href="#索引知识系列二：联合索引、覆盖索引（covering-index）和索引条件下推（index-condition-pushdown-icp）详解" class="headerlink" title="索引知识系列二：联合索引、覆盖索引（covering index）和索引条件下推（index condition pushdown, icp）详解"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/mffandxx/article/details/111916252">索引知识系列二：联合索引、覆盖索引（covering index）和索引条件下推（index condition pushdown, icp）详解</a></h2><h2 id="Innodb是如何实现事务的"><a href="#Innodb是如何实现事务的" class="headerlink" title="Innodb是如何实现事务的"></a>Innodb是如何实现事务的</h2><p>Innodb通过Buffer Pool，LogBuffer，Redo Log，Undo Log来实现事务，以一个update语句为例</p>
<ol>
<li>Innodb在收到一个update语句后，会先根据条件查找到数据所在的页，并将该页缓存在Buffer Pool中</li>
<li>执行update语句，修改Buffer Pool中的数据，也就是内存中的数据</li>
<li>针对update语句生成一个RedoLog对象并存入LogBuffer中</li>
<li>针对update语句生成UndoLog日志，用于事务回滚</li>
<li>如果事务提交，那么则把RedoLog对象进行持久化，后续还有其他机制将Buffer Pool中所修改的数据页持久化到磁盘中</li>
<li>如果事务回滚，则利用undolog日志进行回滚</li>
</ol>
<h2 id="mysql-插入加锁-MySQL锁-山东石头的博客-CSDN博客"><a href="#mysql-插入加锁-MySQL锁-山东石头的博客-CSDN博客" class="headerlink" title="mysql 插入加锁_MySQL锁_山东石头的博客-CSDN博客"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_34553861/article/details/112380759">mysql 插入加锁_MySQL锁_山东石头的博客-CSDN博客</a></h2>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/SQL/">#SQL</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MySQL基础</div>
      <div>https://carl-chu.github.io/2021/08/06/MySQL基础/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>CarlChu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年8月6日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/06/MyBatis/" title="MyBatis">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">MyBatis</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/08/06/JVM/" title="JVM">
                        <span class="hidden-mobile">JVM</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
